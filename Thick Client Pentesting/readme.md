### Amazing Resources

| S.N | Credit            | Resources links                                                                                      |
|-----|-------------------|------------------------------------------------------------------------------------------------------|
| 1.  | CyberArk          | [Thick Client Penetration Testing Methodology](https://www.cyberark.com/resources/threat-research-blog/thick-client-penetration-testing-methodology) |
| 2.  | Dark Relay        | [Thick Client Penetration Testing](https://www.darkrelay.com/post/thick-client-penetration-testing)  |
| 3.  | Payatu            | [Thick Client Penetration Testing](https://payatu.com/blog/thick-client-penetration-testing/)        |
| 4.  | QualySec          | [Thick Client Pen Testing: A Comprehensive Guide](https://qualysec.com/thick-client-pen-testing-a-comprehensive-guide/) |
| 5.  | Medium            | [Thick Client Security Testing: The Essential Guide](https://medium.com/@abhishek.offsec/thick-client-security-testing-the-essential-guide-78f0015ed94f) |
| 6.  | Infosec Writeups  | [Thick Client Pentest: Modern Approaches and Techniques (Part 1)](https://infosecwriteups.com/thick-client-pentest-modern-approaches-and-techniques-part-1-7bb0f5f28e8e) |
| 7.  | Threat Intelligence| [Thick Client Application Penetration Test](https://www.threatintelligence.com/blog/thick-client-application-penetration-test) |


### Common Tools

| S.N | Common Tools                                                                                     | Common Vulnerability                                      |
| --- | ------------------------------------------------------------------------------------------------ | --------------------------------------------------------- |
| 1.  | [Echo Mirage](https://sourceforge.net/projects/echomirage.oldbutgold.p/)                         | <span style="color:red">Sensitive data leakage</span>     |
| 2.  | [Procmon](https://docs.microsoft.com/en-us/sysinternals/downloads/procmon)                       | <span style="color:blue">DLL Hijacking</span>             |
| 3.  | [Strings.exe](https://docs.microsoft.com/en-us/sysinternals/downloads/strings)                   | <span style="color:green">Improper Error Handling</span>  |
| 4.  | [Sysinternals Suite](https://docs.microsoft.com/en-us/sysinternals/downloads/sysinternals-suite) | <span style="color:orange">Injection</span>               |
| 5.  | [Nmap](https://nmap.org/download.html)                                                           | <span style="color:purple">Reverse Engineering</span>     |
| 6.  | [Testssl](https://testssl.sh/)                                                                   | <span style="color:teal">Session Management</span>        |
| 7.  | [Process Hacker](https://processhacker.sourceforge.io/)                                          | <span style="color:maroon">Insecure Storage</span>        |
| 8.  | [Dnspy/ Dot Peek/ VB decompiler](https://github.com/dnSpy/dnSpy/releases)                        | <span style="color:navy">SSL/TLS</span>                   |
| 9.  | [Metasploit (To create Mal. DLL file)](https://www.metasploit.com/download)                      | <span style="color:indigo">Business Logic</span>          |
| 10. | [Fiddler/Burpsuite](https://www.telerik.com/fiddler)                                             | <span style="color:crimson">Weak encryption checks</span> |
| 11. | [Wireshark](https://www.wireshark.org/download.html)                                             | <span style="color:brown">Memory Corruption</span>        |
| 12. | [Ollydbg](https://www.ollydbg.de/)                                                               | <span style="color:darkcyan">Command Injection</span>     |
| 13. | [.Net Reflector](https://www.red-gate.com/products/dotnet-development/reflector/)                | <span style="color:darkred">Unauthenticated Access</span> |
| 14. | [Winhex](https://www.x-ways.net/winhex/)                                                         | <span style="color:chocolate">Resource Exhaustion</span>  |



### **Commaon programming laguage used for Thick Client application development**

| S.N | Language              |
| --- | ---------------------- |
| 1.  | [.NET](https://dotnet.microsoft.com/) |
| 2.  | [Java](https://www.java.com/) |
| 3.  | [C/C++](https://en.wikipedia.org/wiki/C%2B%2B) |
| 4.  | [Microsoft Silverlight](https://www.microsoft.com/silverlight/) |

### **Common Vulnerability**


| S.N | Vulnerability |
| --- | ------------- |
| 1. | Hard-Coded Secrets in source code |
| 2. | Insecure Communication |
| 3. | Buffer Overflow |
| 4. | DLL Hijacking |
| 5. | DEBUG is enabled |
| 6. | SQL Injection |
| 7. | Improper Exception Handling |
| 8. | Command Injection |
| 9. | Information Disclosure by Stack Trace Error |
| 10. | Insecure Direct Object References (IDOR) |
| 11. | Security Misconfiguration |
| 12. | Unvalidated Redirects and Forwards |
| 13. | Broken Authentication |
| 14. | Insecure Deserialization |
| 15. | Missing Function-Level Access Control |
| 16. | Remote Code Execution (RCE) |
| 17. | Application Logs in Clear Text |


### Check List

| S.N | Credit                    | Resources links                                                                                      |
|-----|---------------------------|------------------------------------------------------------------------------------------------------|
| 1.  | Hari-prasaanth            | [Thick Client Pentest Checklist](https://github.com/Hari-prasaanth/Thick-Client-Pentest-Checklist)  |
| 2.  | m14r41                    | [PentestingEverything Repository](https://github.com/m14r41/PentestingEverything)                     |


### Github Resouces

| S.N | Credit  | Resources Links                                                                                      |
|-----|---------|------------------------------------------------------------------------------------------------------|
| 1.  | RaKKeN  | [RaKKeN - Thick Client Penetration Testing](https://github.com/RakeshKengale/RaKKeN/blob/master/Index/Thick_Client.md) |


### Vulnerable Thick Client Application
| S.N | Credit               | Resources Links                                                                                      |
|-----|----------------------|------------------------------------------------------------------------------------------------------|
| 1.  | srini0x00            | [DVTA](https://github.com/srini0x00/dvta)                                                             |
| 2.  | kartikdurg           | [Terrible Thick Client](https://github.com/kartikdurg/Terrible-Thick-Client)                         |
| 3.  | Warxim               | [Vucsa](https://github.com/Warxim/vucsa)                                                               |
| 4.  | DarkRelayLabs        | [VWA](https://github.com/DarkRelayLabs/VWA)                                                            |
| 5.  | NetSPI               | [BetaFast](https://github.com/NetSPI/BetaFast)                                                         |

---
    
# THICK CLIENT PENTESTING CHECKLIST

## INFORMATION GATHERING

### 1. Information Gathering

- ☐ Find out the application architecture (two-tier or three-tier)
- ☐ Find out the technologies used (languages and frameworks)
- ☐ Identify network communication
- ☐ Observe the application process
- ☐ Observe each functionality and behavior of the application
- ☐ Identify all the entry points
- ☐ Analyze the security mechanism (authorization and authentication)

### 2. Tools Used

- ☐ [CFF Explorer](http://www.ntcore.com/exsuite.php)
- ☐ [Sysinternals Suite](https://docs.microsoft.com/en-us/sysinternals/downloads/sysinternals-suite)
- ☐ [Wireshark](https://www.wireshark.org/download.html)
- ☐ [PEid](https://www.aldeid.com/wiki/PEiD)
- ☐ [Detect It Easy (DIE)](https://ntinfo.biz/index.html)
- ☐ [Strings](https://docs.microsoft.com/en-us/sysinternals/downloads/strings)

## GUI TESTING

### 1. Test For GUI Object Permission

- ☐ Display hidden form object
- ☐ Try to activate disabled functionalities
- ☐ Try to uncover the masked password

### 2. Test GUI Content

- ☐ Look for sensitive information

### 3. Test For GUI Logic

- ☐ Try for access control and injection-based vulnerabilities
- ☐ Bypass controls by utilizing intended GUI functionality
- ☐ Check improper error handling
- ☐ Check weak input sanitization
- ☐ Try privilege escalation (unlocking admin features to normal users)
- ☐ Try payment manipulation

### 4. Tools Used

- ☐ [UISpy](https://msdn.microsoft.com/en-us/library/windows/desktop/dd317978.aspx)
- ☐ [Winspy++](https://www.catch22.net/software/winspy-17)
- ☐ [Window Detective](http://windowdetective.sourceforge.net/)
- ☐ [Snoop WPF](https://github.com/snoopwpf/snoopwpf)

## FILE TESTING

### 1. Test For Files Permission

- ☐ Check permission for each and every file and folder

### 2. Test For File Continuity

- ☐ Check strong naming
- ☐ Authenticate code signing

### 3. Test For File Content Debugging

- ☐ Look for sensitive information on the file system (symbols, sensitive)
- ☐ Look for sensitive information in the config file
- ☐ Look for hardcoded encryption data
- ☐ Look for clear text storage of sensitive data
- ☐ Look for side-channel data leakage
- ☐ Look for unreliable logs

### 4. Test For File And Content Manipulation

- ☐ Try framework backdooring
- ☐ Try DLL preloading
- ☐ Perform race condition check
- ☐ Test for files and content replacement
- ☐ Test for client-side protection bypass using reverse engineering

### 5. Test For Function Exported

- ☐ Try to find the exported functions
- ☐ Try to use the exported functions without authentication

### 6. Test For Public Methods

- ☐ Make a wrapper to gain access to public methods without authentication

### 7. Test For Decompile And Application Rebuild

- ☐ Try to recover the original source code, passwords, keys
- ☐ Try to decompile the application
- ☐ Try to rebuild the application
- ☐ Try to patch the application

### 8. Test For Decryption And Deobfuscation

- ☐ Try to recover original source code
- ☐ Try to retrieve passwords and keys
- ☐ Test for lack of obfuscation

### 9. Test For Disassemble And Reassemble

- ☐ Try to build a patched assembly

### 10. Tools Used

- ☐ [Strings](https://docs.microsoft.com/en-us/sysinternals/downloads/strings)
- ☐ [dnSpy](https://github.com/dnSpy/dnSpy/releases)
- ☐ [Procmon](https://docs.microsoft.com/en-us/sysinternals/downloads/procmon)
- ☐ [Process Explorer](https://docs.microsoft.com/en-us/sysinternals/downloads/process-explorer)
- ☐ [Process Hacker](https://processhacker.sourceforge.io/)
- ☐ [HxD](https://mh-nexus.de/en/hxd/)
- ☐ [PESecurity](https://github.com/NetSPI/PESecurity)

## REGISTRY TESTING

### 1. Test For Registry Permissions

- ☐ Check read access to the registry keys
- ☐ Check write access to the registry keys

### 2. Test For Registry Contents

- ☐ Inspect the registry contents
- ☐ Check for sensitive info stored in the registry
- ☐ Compare the registry before and after executing the application

### 3. Test For Registry Manipulation

- ☐ Try for registry manipulation
- ☐ Try to bypass authentication by registry manipulation
- ☐ Try to bypass authorization by registry manipulation

### 4. Tools Used

- ☐ [Regshot](https://sourceforge.net/projects/regshot/)
- ☐ [Procmon](https://docs.microsoft.com/en-us/sysinternals/downloads/procmon)
- ☐ [AccessEnum](https://docs.microsoft.com/en-us/sysinternals/downloads/accessenum)

## NETWORK TESTING

### 1. Test For Network

- ☐ Check for sensitive data in transit
- ☐ Try to bypass firewall rules
- ☐ Try to manipulate network traffic

### 2. Tools Used

- ☐ [Wireshark](https://www.wireshark.org/download.html)
- ☐ [TCPView](https://docs.microsoft.com/en-us/sysinternals/downloads/tcpview)

## ASSEMBLY TESTING

### 1. Test For Assembly

- ☐ Verify Address Space Layout Randomization (ASLR)
- ☐ Verify SafeSEH
- ☐ Verify Data Execution Prevention (DEP)
- ☐ Verify strong naming
- ☐ Verify ControlFlowGuard
- ☐ Verify HighentropyVA

### 2. Tools Used

- ☐ [PESecurity](https://github.com/NetSPI/PESecurity)

## MEMORY TESTING

### 1. Test For Memory Content

- ☐ Check for sensitive data stored in memory

### 2. Test For Memory Manipulation

- ☐ Try for memory manipulation
- ☐ Try to bypass authentication by memory manipulation
- ☐ Try to bypass authorization by memory manipulation

### 3. Test For Runtime Manipulation

- ☐ Try to analyze the dump file
- ☐ Check for process replacement
- ☐ Check for modifying assembly in the memory
- ☐ Try to debug the application
- ☐ Try to identify dangerous functions
- ☐ Use breakpoints to test each and every functionality

### 4. Tools Used

- ☐ [Process Hacker](https://processhacker.sourceforge.io/)
- ☐ [HxD](https://mh-nexus.de/en/hxd/)
- ☐ [Strings](https://docs.microsoft.com/en-us/sysinternals/downloads/strings)

## TRAFFIC TESTING

### 1. Test For Traffic

- ☐ Analyze the flow of network traffic
- ☐ Try to find sensitive data in transit

### 2. Tools Used

- ☐ [Echo Mirage](https://sourceforge.net/projects/echomirage.oldbutgold.p/)
- ☐ [MITM Relay](https://github.com/SpiderLabs/Responder)
- ☐ [Burp Suite](https://portswigger.net/burp)

## COMMON VULNERABILITIES TESTING

### 1. Test For Common Vulnerabilities

- ☐ Try to decompile the application
- ☐ Try reverse engineering
- ☐ Try to test with OWASP WEB Top 10
- ☐ Try to test with OWASP API Top 10
- ☐ Test for DLL Hijacking
- ☐ Test for signature checks (Use [Sigcheck](https://docs.microsoft.com/en-us/sysinternals/downloads/sigcheck))
- ☐ Test for binary analysis (Use [Binscope](https://github.com/microsoft/binscope))
- ☐ Test for business logic errors
- ☐ Test for TCP/UDP attacks
- ☐ Test with automated scanning tools (Use [VisualCode Grepper - VCG](https://github.com/vcg/VisualCodeGrepper))


## Thick Client Application Security Testing

> Thick client applications are any that are installed locally on a user's desktop/laptop. These applications are full-featured and can run independently without being connected to the Internet, unlike web applications, which need to be connected to the Internet all the time. Some examples of thick client applications are:

1.  Computer games like Call of Duty, Uncharted, etc.
2.  Web browsers
3.  Music players
4.  Video and chat tools like Teams, Zoom, Slack, etc.

>**Thick client applications come in two flavors**

| Two-Tier Applications         | Three-Tier Applications     |
|---|------------|
| These are self-contained applications where the server/database and client are installed on the same machine or same internal network. Traffic from the thick client goes to the server directly without passing through an intermediary like the Internet or application server | These applications can connect over the Internet and have their business logic processed by an application server. The thick client resides on the user's desktop while the application server and database might be present elsewhere. Network connections and interactions typically usually happen using HTTP/S protocols, which allow for traditional requests / responses to occur. In addition, some thick clients may use alternate protocols like FTP/S, TCP, UDP, etc |
---



| Tool Name                                                                                              | Description                                                                                                                                                                                                                                                                                                                                                    |
| ------------------------------------------------------------------------------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| [Echo Mirage](https://sourceforge.net/projects/echomirage.oldbutgold.p/)                               | This is the Swiss army knife of thick client testing tools. Echo Mirage, which is similar to Burp / OWASP Zap, allows for traffic between client and server to be intercepted. Unlike Burp, there is no certificate to be installed locally (even though Echo Mirage can intercept encrypted traffic between client and server).                               |
| [Sysinternals Suite](https://download.sysinternals.com/files/SysinternalsSuite.zip)                    | This comprehensive suite of tools from Microsoft allows testers to see what processes are spawned by the thick client application and the registry entries created or accessed by the thick client. Procmon and Regmon are two of the common tools in Sysinternals used to check for processes and registry entries. The suite also contains many other tools. |
| [Mallory](https://github.com/intrepidusgroup/mallory)                                                  | This Linux-based tool can be used to capture TCP / UDP traffic.                                                                                                                                                                                                                                                                                                |
| [dnspy](https://github.com/dnSpy/dnSpy/releases/download/v6.1.8/dnSpy-net-win64.zip)                   | .Net based thick clients may have hardcoded data or source code which may not be obfuscated. dnSpy allows for deobfuscation and inspection of DLL files.                                                                                                                                                                                                       |
| [NoPE](https://github.com/summitt/Burp-Non-HTTP-Extension) Burp Extension                              | Burp has an invisible mode which allows for capturing traffic for proxy-unaware thick clients. This can be done by binding the loopback address to the remote domain / IP address. BAPP has NoPE Burp Extension, which is a good add-on for working with thick client traffic.                                                                                 |
| [Java Snoop](http://code.google.com/p/javasnoop/downloads/list)                                        | For Java thick clients, this allows for interception of any method in the JVM. Java Snoop works on existing Java processes by attaching itself to the running process.                                                                                                                                                                                         |
| [Ollydbg](https://www.ollydbg.de/odbg110.zip)                                                          | Useful for reverse-engineering EXE and DLL files. Hex Editors and Strings are other tools which can be useful when searching for strings / keywords.                                                                                                                                                                                                           |
| [Nmap](https://nmap.org/download)                                                                      | Useful for inspecting ports used by the thick client.                                                                                                                                                                                                                                                                                                          |
| [Spy++](https://docs.microsoft.com/en-us/visualstudio/debugger/introducing-spy-increment?view=vs-2022) | This ships with Visual Studio and can be used for GUI Tampering.                                                                                                                                                                                                                                                                                               |


| S.N | Credits                                                                                                         |
| --- | --------------------------------------------------------------------------------------------------------------- |
| 1   | [Viraj Moto](https://medium.com/@virajmota38?source=post_page-----7bb0f5f28e8e--------------------------------) |
| 2   | [optiv.com](https://www.optiv.com/insights/source-zero/blog/thick-client-application-security-testing)          |

| S.N | On the Basis of | Thin Client                                                                                        | Thick Client                                                                                     |
| --- | --------------- | -------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------ |
| 1.  | Basic           | Thin client is a lightweight computer that relies on the resources of the host computer.           | The thick client relies lightly upon the server and provides rich functionality.                 |
| 2.  | Datastore       | In thin client, data is stored in servers.                                                         | In thick client, data is stored locally.                                                         |
| 3.  | Network Latency | In thin client, a fast and robust network connection is required.                                  | It can work with a slow network connection.                                                      |
| 4.  | Offline Working | There is no offline working.                                                                       | Offline working is possible in thick client.                                                     |
| 5.  | Deployment      | The deployment is easier in thin client.                                                           | Unlike the thin client, the deployment in thick client is expensive.                             |
| 6.  | Data Validation | In thin client, the data verification is done at the server side.                                  | In thick client, the data verification is done at the client side.                               |
| 7.  | Local Resources | It generally consumes less local resources.                                                        | Unlike thin client, it consumes more local resources.                                            |
| 8.  | Security        | In terms of security, they are more secure than thick clients as they have fewer security threats. | In terms of security, they are less secure than thin clients as they have more security threats. |


# Android Pentesting MindMap:
![Android Pentesting Mid - by h0tPlug1n ](https://github.com/user-attachments/assets/3e721b5b-5b3b-4302-88b7-78f2833cb7b3)

> MindMap Credit  : [h0tPlug1n](https://github.com/h0tPlug1n)

## Setup Android Pentesting Lab
1. **Download any emulator.**
	- [Genymotion](https://www.genymotion.com/download/)
	- [NoxPlayer](https://www.bignox.com/)

2.  **Proxy Configuration**
	- Export burpsuite certificate
	- Configured port and interface in burp sute.
	- Setup manul proxy in android device and enter the ip and port of burp config.
	- Send Burpsuite certificate in android and install.
	- Burp configuration done.


3.  **Setting upFrida.**
	- Check androi architecture and download  accordingly [frida-server](https://github.com/frida/frida/releases)
		-  `adb shell getprop ro.product.cpu.abi` // Check architecture
	- Download the burp certificate and renamed it as *cert-der.crt* 
	- Now send the frida-server and burp certificate in android location */data/local/tmp*
	- Done!

   ## Check packages

- `adb shell pm list packages`
- `adb shell pm list packages -f`
- `adb shell pm list packages | Select-String "camera"`
- `adb shell pm list packages | grep camera`

## SSL Pinning Bypass command



4. **SSL Unpinning using Frida**
	- Run frida sever in android 
		- `adb shell`
		- `cd /local/data/tmp`
		- `./frida-server`
	- Few more frida command
		- `/data/local/tmp # ps -e | grep frida-server`
		 - `adb shell "pm list packages -f"`
		 - `frida-ps -Uai //get identifire`
		 - `frida-ps -Ua` // list running applications pkg
	- Now finally run
		-  frida -U -f com.<pakage> -l ssl-fridascript.js
   
```bash
- `-f`: Specifies the target application package name (`com.zeptoconsumerapp`) to attach to.
- `-l`: Specifies the Frida script file (`fridascript.js`) to load and execute.
- `-U`: Specifies that the target device is connected over USB.
```

	- **SSL Unpinning using Exposed Modul**
		- Clone the the repository [Exposed-Modul](https://github.com/ac-pm/SSLUnpinning_Xposed.git)
		- `cd /SSLUnpinning_Xposed`
		- ` adb install mobi.acpm.sslunpinning_latest.apk`
		- Open in android and check for SSL unpinning.

5. Root Dedection Bypass Using Frida
	- `frida -U --codeshare dzonerzy/fridantiroot -f in.<package company>.<package name`




| S.N | links                                                                                       |
| --- | ------------------------------------------------------------------------------------------- |
| 1   | https://workbook.securityboat.in/resources/android-app-pentest                              |
| 2   | https://infosecwriteups.com/mobile-pentesting-androgoat-assessment-walkthrough-1a63a7edc677 |


---
---
# MOBILE PENTESTING CHECKLIST

## Information Gathering

### ☐ Identify the target mobile platform (iOS, Android).
   - Determine the OS version and device details.

### ☐ Gather information about the mobile application.
   - **Tools:** Google Play Store, Apple App Store, Mobile Application Binary
   - **Command:** `adb pull <app_path>`
   - Look for app version, developer information, and permissions.

### ☐ Identify the app's backend services and APIs.
   - Discover endpoints, authentication mechanisms, and data flow.

### ☐ Discover the app's functionality and features.
   - Create a detailed app map with all functionalities.

### ☐ Enumerate app permissions and security configurations.
   - **Tools:** Mobile Device Settings, Mobile Application Permissions
   - **Command:** Check app settings and permissions
   - Identify overly permissive or unnecessary permissions.

## Static Analysis

### ☐ Decompile the mobile app binary.
   - **Tools:** JADX, JADX-GUI (for Android), Hopper Disassembler (for iOS)
   - **Command:** `jadx -d <output_dir> <app_apk>`
   - Analyze the source code for vulnerabilities.
   - Examine the manifest file for declared permissions.

### ☐ Inspect hardcoded credentials and sensitive data.
   - Search for API keys, passwords, or encryption keys in the code.

### ☐ Identify code injection points and potential security flaws.
   - Look for SQL injection, command injection, and other injection vulnerabilities.

### ☐ Review the app's encryption and data storage methods.
   - **Tools:** Apktool (for Android), Class-dump (for iOS)
   - **Command:** `apktool d <app_apk> -o <output_dir>`
   - Verify how data is encrypted, stored, and accessed.


1. **Cryptography:**
   - Look for use of encryption algorithms and verify implementation correctness.
   - Check for hardcoded keys, weak encryption methods, or use of insecure cryptographic algorithms.

2. **Code Obfuscation:**
   - Check for obfuscation techniques used to hide code.
   - Verify that obfuscation does not hide malicious code.

3. **API Usage:**
   - Verify absence of insecure or vulnerable APIs.
   - Look for APIs allowing unauthorized access or data leakage.

4. **Hardcoded Sensitive Information:**
   - Look for insecure storage of sensitive data.
   - Check for hardcoded database queries, passwords, keys, or URLs.

5. **External Libraries:**
   - Verify absence of insecure or vulnerable third-party libraries.

6. **Integrity Checks:**
   - Look for integrity checks to prevent tampering with code.

7. **Native Code:**
   - If present, verify secure compilation of native code.

8. **Web View Related Checks:**
   - `setJavaScriptEnabled()`: Ensure proper validation of input data to prevent injection of malicious JavaScript code.
   - `setAllowFileAccess()`: Validate input data to prevent unauthorized access/modification of local files.
   - `addJavascriptInterface()`: Validate input data to prevent execution of arbitrary Java code.
   - `runtime.exec()`: Prevent injection of malicious input data to avoid execution of arbitrary shell commands.

9. **Root Detection Implementation Details:**
   - Verify implementation details of root detection mechanisms.

10. **SSL Pinning Implementation Details:**
   - Review implementation details of SSL pinning to ensure secure communication.




## Dynamic Analysis

### ☐ Install and run the app on a mobile device or emulator.
   - **Tools:** Android Emulator (for Android), Xcode Simulator (for iOS)
   - Observe app behavior in a controlled environment.

### ☐ Intercept and manipulate network traffic.
   - **Tools:** Burp Suite, Charles Proxy, Wireshark
   - Analyze API calls, data transmission, and encryption.
   - Test for insecure data storage and transmission.

### ☐ Test for authentication and session management vulnerabilities.
   - Attempt session fixation, session hijacking, or token manipulation.

### ☐ Execute runtime analysis for code behavior.
   - **Tools:** Frida, Cycript, LLDB (for iOS)
   - **Command:** Use Frida scripts for dynamic analysis
   - Test for code manipulation, function hooking, and runtime attacks.

## Authentication and Authorization

### ☐ Test for weak authentication mechanisms.
   - Try common credentials, default passwords, or weak password policies.
   - Check for credential stuffing attacks.

### ☐ Attempt brute force attacks on login screens.
   - **Tools:** Hydra, Burp Suite, OWASP ZAP
   - **Command:** `hydra -l <username> -P <password_file> <target>`
   - Test for account lockouts, CAPTCHA bypass, or rate limiting issues.

### ☐ Verify session management security.
   - Test for session fixation, session timeout, and session ID randomness.
   - Check for secure token storage and transmission.

### ☐ Test for privilege escalation vulnerabilities.
   - Check role-based access control (RBAC) and permissions.

### ☐ Check for insecure direct object references.
   - Test for unauthorized data access through object manipulation.

## Data Validation and Security

### ☐ Test for input validation vulnerabilities.
   - Try SQL injection, command injection, and XSS attacks.
   - Check for input validation on all user inputs.

### ☐ Verify encryption of sensitive data.
   - Check encryption algorithms and key management.
   - Test for data leakage through logs or memory.

### ☐ Look for insecure data transmission.
   - Inspect SSL/TLS configurations and certificate validation.
   - Test for SSL pinning bypass.

### ☐ Test for secure file handling.
   - Check file I/O operations, file permissions, and storage.

### ☐ Verify the use of secure coding practices.
   - Check for OWASP Mobile Top 10 vulnerabilities.

## Runtime Manipulation

### ☐ Use runtime analysis tools to modify app behavior.
   - Inject code, intercept API calls, and manipulate data.

### ☐ Test for API vulnerabilities.
   - Check for API rate limiting, input validation, and authentication.

### ☐ Attempt to execute malicious code on the device.
   - Test for privilege escalation, root/jailbreak detection bypass, and malware installation.

### ☐ Test for reverse engineering and tampering detection.
   - Check for code obfuscation, anti-debugging, and app integrity checks.

## Reporting

### ☐ Document findings, vulnerabilities, and their impact.
   - Create a detailed report with evidence and screenshots.


